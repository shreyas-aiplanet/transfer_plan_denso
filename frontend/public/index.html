<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Denso - Transfer Plan Recommendation</title>
    <link rel="stylesheet" href="../src/styles/main.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header>
            <div class="header-content">
                <div class="denso-logo">
                    <img src="../assets/Denso.png" alt="DENSO" class="logo-image">
                    <div class="logo-subtitle">Transfer Plan Recommendation System</div>
                </div>
                <div class="powered-by">Powered by AI Planet</div>
            </div>
        </header>

        <!-- Main Layout: Sidebar + Content -->
        <div class="main-layout">
            <!-- Left Sidebar for Sessions -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h3>Sessions</h3>
                    <button class="btn-icon" id="newSessionBtn" title="New Session">+</button>
                </div>
                <div class="sessions-list" id="sessionsList">
                    <div class="session-item active" data-session="default">
                        <div class="session-info">
                            <div class="session-name">Default Session</div>
                            <div class="session-date">Active</div>
                        </div>
                    </div>
                </div>

                <div class="sidebar-footer">
                    <div class="session-stats" id="sessionStats">
                        <div class="stat-item">
                            <span class="stat-label">Products:</span>
                            <span class="stat-value" id="productCount">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Plants:</span>
                            <span class="stat-value" id="plantCount">0</span>
                        </div>
                    </div>
                    <div class="quick-actions">
                        <h4>Quick Actions</h4>
                        <button id="clearDataBtn" class="sidebar-btn btn-danger">
                            Clear All Data
                        </button>
                    </div>
                </div>
            </aside>

            <!-- Main Content Area -->
            <div class="content-wrapper">
                <!-- Step Progress Indicator -->
                <div class="stepper">
                    <div class="step active" data-step="1">
                        <div class="step-number">1</div>
                        <div class="step-label">Data Management</div>
                    </div>
                    <div class="step-divider"></div>
                    <div class="step" data-step="2">
                        <div class="step-number">2</div>
                        <div class="step-label">Generate Plan</div>
                    </div>
                    <div class="step-divider"></div>
                    <div class="step" data-step="3">
                        <div class="step-number">3</div>
                        <div class="step-label">Results</div>
                    </div>
                </div>

                <main>
                    <!-- Data Management Tab (Combined Products + Plants) -->
                    <section id="data-management-tab" class="tab-content active">
                        <div class="page-header">
                            <h2>Data Management</h2>
                            <p class="section-description">Manage products and plants for transfer plan optimization</p>
                        </div>

                        <!-- Sub-tabs for Products and Plants -->
                        <div class="sub-tabs">
                            <button class="sub-tab-btn active" data-subtab="products">Products</button>
                            <button class="sub-tab-btn" data-subtab="plants">Plants</button>
                        </div>

                        <!-- Products Section -->
                        <div id="products-section" class="sub-tab-content active">
                            <div class="card">
                                <div class="card-header">
                                    <h3>Products List</h3>
                                    <div style="display: flex; gap: 10px;">
                                        <button id="loadProducts" class="btn-secondary">Refresh</button>
                                        <button id="uploadProductsCSVBtn" class="btn-primary">Upload CSV</button>
                                        <input type="file" id="productsCSVUpload" accept=".csv" style="display: none;">
                                    </div>
                                </div>
                                <div id="productsList" class="data-table"></div>
                            </div>

                            <div class="card">
                                <h3>Add New Product</h3>
                                <form id="addProductForm" class="form-grid">
                                    <div class="form-group">
                                        <label for="productId">Product ID (SKU) *</label>
                                        <input type="text" id="productId" placeholder="e.g., SKU-001" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="currentPlantId">Current Plant ID *</label>
                                        <input type="text" id="currentPlantId" placeholder="e.g., PLANT-JP-01" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="monthlyDemand">Monthly Demand (pcs) *</label>
                                        <input type="number" id="monthlyDemand" placeholder="e.g., 10000" step="1" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="currentUnitCost">Current Unit Cost ($) *</label>
                                        <input type="number" id="currentUnitCost" placeholder="e.g., 25.50" step="0.01" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="unitVolume">Unit Volume/Weight</label>
                                        <input type="number" id="unitVolume" placeholder="Optional" step="0.01" min="0">
                                    </div>
                                    <div class="form-group">
                                        <label for="cycleTime">Cycle Time (sec)</label>
                                        <input type="number" id="cycleTime" placeholder="Optional" step="0.1" min="0">
                                    </div>
                                    <div class="form-group">
                                        <label for="yieldRate">Yield Rate (%)</label>
                                        <input type="number" id="yieldRate" placeholder="Optional" step="0.1" min="0" max="100">
                                    </div>
                                    <div class="form-group full-width">
                                        <button type="submit" class="btn-primary">Add Product</button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!-- Plants Section -->
                        <div id="plants-section" class="sub-tab-content">
                            <div class="card">
                                <div class="card-header">
                                    <h3>Plants List</h3>
                                    <div style="display: flex; gap: 10px;">
                                        <button id="loadPlants" class="btn-secondary">Refresh</button>
                                        <button id="uploadPlantsCSVBtn" class="btn-primary">Upload CSV</button>
                                        <input type="file" id="plantsCSVUpload" accept=".csv" style="display: none;">
                                    </div>
                                </div>
                                <div id="plantsList" class="data-table"></div>
                            </div>

                            <div class="card">
                                <h3>Add New Plant</h3>
                                <form id="addPlantForm" class="form-grid">
                                    <div class="form-group">
                                        <label for="plantId">Plant ID *</label>
                                        <input type="text" id="plantId" placeholder="e.g., PLANT-JP-01" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="availableCapacity">Available Capacity (pcs/month) *</label>
                                        <input type="number" id="availableCapacity" placeholder="e.g., 50000" step="1" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="unitProductionCost">Unit Production Cost ($) *</label>
                                        <input type="number" id="unitProductionCost" placeholder="e.g., 22.00" step="0.01" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="transferFixedCost">Transfer Fixed Cost ($) *</label>
                                        <input type="number" id="transferFixedCost" placeholder="e.g., 50000" step="0.01" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="effectiveOEE">Effective OEE (0-1)</label>
                                        <input type="number" id="effectiveOEE" placeholder="e.g., 0.85" step="0.01" min="0" max="1" value="1.0">
                                    </div>
                                    <div class="form-group">
                                        <label for="leadTimeToStart">Lead Time to Start (months)</label>
                                        <input type="number" id="leadTimeToStart" placeholder="e.g., 3" step="0.1" min="0" value="0">
                                    </div>
                                    <div class="form-group">
                                        <label for="riskScore">Risk Score (0-1)</label>
                                        <input type="number" id="riskScore" placeholder="Optional" step="0.01" min="0" max="1">
                                    </div>
                                    <div class="form-group">
                                        <label for="maxUtilization">Max Utilization Target (%)</label>
                                        <input type="number" id="maxUtilization" placeholder="e.g., 90" step="1" min="0" max="100" value="90">
                                    </div>
                                    <div class="form-group full-width">
                                        <button type="submit" class="btn-primary">Add Plant</button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!-- Step Navigation -->
                        <div class="step-navigation">
                            <button type="button" class="btn-secondary" id="prevStep1" style="visibility: hidden;">Previous</button>
                            <button type="button" class="btn-primary" id="nextStep1">Next: Generate Plan</button>
                        </div>
                    </section>

                    <!-- Transfer Plan Tab -->
                    <section id="transfer-plan-tab" class="tab-content">
                        <div class="page-header">
                            <h2>Generate Transfer Plan</h2>
                            <p class="section-description">Configure optimization parameters and generate transfer plan recommendations</p>
                        </div>

                        <div class="card highlighted-card">
                            <h3>Optimization Configuration</h3>
                            <form id="generatePlanForm" class="form-grid">
                                <div class="form-group">
                                    <label for="budgetCapital">Budget Capital ($)</label>
                                    <input type="number" id="budgetCapital" placeholder="Optional - leave blank for no limit" step="0.01" min="0">
                                </div>
                                <div class="form-group">
                                    <label for="transferDeadline">Transfer Deadline</label>
                                    <input type="date" id="transferDeadline" placeholder="Optional">
                                </div>
                                <div class="form-group">
                                    <label for="discountRate">Discount Rate (0-1)</label>
                                    <input type="number" id="discountRate" placeholder="Optional" step="0.01" min="0" max="1">
                                </div>
                                <div class="form-group">
                                    <label for="objectiveFunction">Objective Function</label>
                                    <select id="objectiveFunction">
                                        <option value="minimize_cost">Minimize Total Cost</option>
                                        <option value="minimize_time">Minimize Time-to-Production</option>
                                        <option value="balance_utilization">Balance Utilization</option>
                                        <option value="multi_objective">Multi-Objective</option>
                                    </select>
                                </div>
                                <div class="form-group full-width">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="allowFractional">
                                        Allow fractional assignment (split production across plants)
                                    </label>
                                </div>
                                <div class="form-group full-width">
                                    <button type="submit" class="btn-primary btn-large">Generate Transfer Plan</button>
                                </div>
                            </form>
                        </div>

                        <div id="planGenerationStatus" class="status-message"></div>

                        <!-- Step Navigation -->
                        <div class="step-navigation">
                            <button type="button" class="btn-secondary" id="prevStep2">Previous: Data Management</button>
                            <button type="button" class="btn-primary" id="nextStep2" disabled>Next: View Results</button>
                        </div>
                    </section>

                    <!-- Results Tab -->
                    <section id="results-tab" class="tab-content">
                        <div class="page-header">
                            <h2>Transfer Plan Results</h2>
                            <p class="section-description">View the optimized transfer plan recommendations</p>
                        </div>

                        <div id="resultsContainer">
                            <div class="empty-state">
                                <p>No transfer plan generated yet</p>
                                <p class="empty-state-hint">Go back to generate a transfer plan</p>
                            </div>
                        </div>

                        <!-- Step Navigation -->
                        <div class="step-navigation">
                            <button type="button" class="btn-secondary" id="prevStep3">Previous: Generate Plan</button>
                            <button type="button" class="btn-primary" id="startOver">Start Over</button>
                        </div>
                    </section>
                </main>
            </div>
        </div>

        <footer>
            <p>&copy; 2025 DENSO Corporation. All rights reserved.</p>
        </footer>
    </div>

    <script src="../src/app.js"></script>
</body>
</html>
